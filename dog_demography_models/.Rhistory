wing.mod1<-lm(winglength~predator+conspecific+sex+trial,data=wing)
summary(wing.mod1)
plot(wing.mod1)
# Try mixed effects model with plate as a random effect
library(lme4)
wing.1<-wing[complete.cases(wing$winglength),]
wing.mod2<-lmer(winglength~predator*conspecific+sex+trial+(1|plate), data=wing.1, REML=FALSE)
summary(wing.mod2)
#Interpreting main effects by ML method, not REML(refer to Crawley page 635)
model1<-update(wing.mod2,~.-trial)
anova(wing.mod2,model1)
model2<-update(wing.mod2,~.-sex)
anova(wing.mod2,model2)
model3<-update(wing.mod2,~.-conspecific:predator)
setwd("/media/manvi/New Volume/Manvi.iisc/Kavita/Thesis_Data/Chapter1Larval_tradeoffs/Analysis_files/Meta_analysis/Sheets_Code_meta")
wing<-read.csv("meta_wing_unique.csv", na.strings=c("","NA","chipped","folded","death"))
setwd("/media/manvi/New Volume/Manvi.iisc/IISc_Phd/Kavita/Thesis_Data/Chapter1Larval_tradeoffs/Analysis_files/Meta_analysis/Sheets_Code_meta")
wing<-read.csv("meta_wing_unique.csv", na.strings=c("","NA","chipped","folded","death"))
str(wing)
#datasheet for proporition surviving analysis
pup_sum<-read.csv("pup_sum.csv", na.strings=c("","NA"))
str(pup_sum)
names(pup_sum)
table(pup_sum$plate_id)
pupa<-read.csv("pupa_meta.csv", na.strings=c("NA",""))
str(pupa)
#Final analysis:
#Question 1 - How does wl change with increasing predators
#Use data only from high densities:100 and 155
#Females
wing<-wing[complete.cases(wing$winglength),]
wingf<-wing[wing$sex=="f",]
wingfh<-wingf[wingf$conspecific==155,]
head(wingfh)
shapiro.test(wingfh$winglength)
str(wingfh)
mod_wingfh<-lm(winglength~predator, data=wingfh)
summary(mod_wingfh)
mod<-update(mod_wingfh,~.-predator)
anova(mod_wingfh, mod,test = "F")
#same question with a mixed effects model ?
str(wingfh)
library(lme4)
m_mod_wingfh<-lmer(winglength~predator+(1|plate), data=wingfh)
summary(m_mod_wingfh)
wing<-wing[complete.cases(wing$winglength),]
wingm<-wing[wing$sex=="m",]
wingmh<-wingm[wingm$conspecific==155,]
head(wingmh)
shapiro.test(wingmh$winglength)
str(wingmh)
mod_wingmh<-lm(winglength~predator, data=wingmh)
summary(mod_wingmh)
mod<-update(mod_wingmh,~.-predator)
anova(mod,mod_wingmh,test = "F")
#Final analysis:
#Question 1 - How does wl change with increasing predators
#Use data only from high densities:100 and 155
#Females
wing<-wing[complete.cases(wing$winglength),]
wingf<-wing[wing$sex=="f",]
wingfh<-wingf[wingf$conspecific==155,]
head(wingfh)
shapiro.test(wingfh$winglength)
str(wingfh)
mod_wingfh<-lm(winglength~predator, data=wingfh)
summary(mod_wingfh)
head(wingfh)
m_mod_wingfh<-lmer(winglength~predator+(1|trial), data=wingfh)
summary(m_mod_wingfh)
##Question 2
#effect of adding one predator
wing1f<-wingf[wingf$predator==0 | wingf$predator==1,]
#for females
head(wing1f)
table(wing1f$conspecific, wing1f$predator)
## using only 45 to 155
wing1f<-wing1f[wing1f$conspecific!=20 & wing1f$conspecific!=30,]
table(wing1f$conspecific, wing1f$predator)
str(wing1f)
wing1f$predator<-as.factor(wing1f$predator)
mod_wing1f<-lm(winglength~predator*conspecific, data=wing1f)
summary(mod_wing1f)
plot(mod_wing1f)
##to assess significance we plotted bootstapped CI
#for females
table(wing1f$predator, wing1f$conspecific)
wing1f<-wing1f[order(wing1f$conspecific),]
wingfh<-wingf[wingf$conspecific==155 | wingf$conspecific==100 ,]
head(wingfh)
shapiro.test(wingfh$winglength)
str(wingfh)
mod_wingfh<-lm(winglength~predator, data=wingfh)
summary(mod_wingfh)
mod<-update(mod_wingfh,~.-predator)
anova(mod_wingfh, mod,test = "F")
#same question with a mixed effects model ?
str(wingfh)
library(lme4)
m_mod_wingfh<-lmer(winglength~predator+(1|plate_id), data=wingfh)
summary(m_mod_wingfh)
m_mod_wingfh<-lmer(winglength~predator+(1|trial), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,-.~predator)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
m_mod_wingfh<-lmer(winglength~predator+(1|trial), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
m_mod_wingfh<-lmer(winglength~predator+(1|plate), data=wingfh)
#same question with a mixed effects model ?
str(wingfh)
m_mod_wingfh<-lmer(winglength~predator+(1|plate), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
wingfh<-wingf[wingf$conspecific==155,]
head(wingfh)
shapiro.test(wingfh$winglength)
str(wingfh)
mod_wingfh<-lm(winglength~predator, data=wingfh)
summary(mod_wingfh)
mod<-update(mod_wingfh,~.-predator)
anova(mod_wingfh, mod,test = "F")
#plot(mod_wingfh)
plot(winglength~predator, data=wingfh, pch=19, ylab="Winglength (mm)", xlab="Predator density")
#same question with a mixed effects model ?
str(wingfh)
library(lme4)
m_mod_wingfh<-lmer(winglength~predator+(1|plate), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
m_mod_wingfh<-lmer(winglength~predator+(1|trial), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
m_mod_wingfh<-lmer(winglength~predator+(1|trial)+(1|plate), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
m_mod_wingfh<-lmer(winglength~predator+trial+(1|plate), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
m_mod_wingfh<-lmer(winglength~predator+trial+(1|plate), data=wingfh)
summary(m_mod_wingfh)
#assess significance
mod1<-update(m_mod_wingfh,~.-predator)
anova(m_mod_wingfh,mod1)
summary(m_mod_wingfh)
wing<-wing[complete.cases(wing$winglength),]
wingm<-wing[wing$sex=="m",]
wingmh<-wingm[wingm$conspecific==155,]
head(wingmh)
shapiro.test(wingmh$winglength)
str(wingmh)
mod_wingmh<-lm(winglength~predator, data=wingmh)
summary(mod_wingmh)
plot(mod_wingmh)
#same question with a mixed effects model
#same question with a mixed effects model ?
str(wingmh)
library(lme4)
m_mod_wingmh<-lmer(winglength~predator+trial+(1|plate), data=wingmh)
summary(m_mod_wingmh)
#assess significance
mod1<-update(m_mod_wingmh,~.-predator)
anova(m_mod_wingmh,mod1)
##Question 2
#effect of adding one predator
wing1f<-wingf[wingf$predator==0 | wingf$predator==1,]
#for females
head(wing1f)
table(wing1f$conspecific, wing1f$predator)
## using only 45 to 155
wing1f<-wing1f[wing1f$conspecific!=20 & wing1f$conspecific!=30,]
table(wing1f$conspecific, wing1f$predator)
str(wing1f)
wing1f$predator<-as.factor(wing1f$predator)
mod_wing1f<-lm(winglength~predator*conspecific, data=wing1f)
summary(mod_wing1f)
#same with mixed effects model
mod_wing1f<-lmer(winglength~predator*conspecific+trial+(1|plate), data=wing1f)
summary(mod_wing1f)
mod1<-update(mod_wing1f,~.-predator:conspecific)
anova(mod_wing1f,mod1)
#same with mixed effects model
mod_wing1f<-lmer(winglength~predator*conspecific+(1|plate), data=wing1f)
summary(mod_wing1f)
mod1<-update(mod_wing1f,~.-predator:conspecific)
anova(mod_wing1f,mod1)
#same with mixed effects model
mod_wing1f<-lmer(winglength~predator*conspecific+(1|plate)+trial, data=wing1f)
summary(mod_wing1f)
mod1<-update(mod_wing1f,~.-predator:conspecific)
anova(mod_wing1f,mod1)
#same with mixed effects model
head(wing1f)
mod_wing1f<-lmer(winglength~predator*conspecific+(1|trial/plate), data=wing1f)
summary(mod_wing1f)
mod1<-update(mod_wing1f,~.-predator:conspecific)
anova(mod_wing1f,mod1)
mod_wing1f<-lmer(winglength~predator*conspecific+(1|plate), data=wing1f)
summary(mod_wing1f)
mod1<-update(mod_wing1f,~.-predator:conspecific)
anova(mod_wing1f,mod1)
mod2<-update(mod_wing1f,~.-predator)
anova(mod2,mod1)
mod2<-update(mod1,~.-predator)
anova(mod2,mod1)
mod3<-update(mod1,~.-conspecific)
anova(mod3,mod1)
## For males
wing1m<-wingm[wingm$predator==0 | wingm$predator==1,]
#for females
head(wing1m)
table(wing1m$conspecific, wing1m$predator)
## using only 45 to 155
wing1m<-wing1m[wing1m$conspecific!=20 & wing1m$conspecific!=30,]
table(wing1m$conspecific, wing1m$predator)
str(wing1m)
mod_wing1m<-lm(winglength~as.factor(predator)*conspecific, data=wing1m)
summary(mod_wing1m)
mod1<-update(mod_wing1m,~.-as.factor(predator):conspecific)
anova(mod_wing1m,mod1)
#same with mixed effects model
head(wing1m)
mod_wing1m<-lmer(winglength~predator*conspecific+(1|plate), data=wing1m)
summary(mod_wing1m)
mod1<-update(mod_wing1m,~.-predator:conspecific)
anova(mod_wing1m,mod1)
mod2<-update(mod1,~.-predator)
anova(mod2,mod1)
mod3<-update(mod1,~.-conspecific)
anova(mod3,mod1)
library(MASS)
str(wing)
summary(wing)
#Final analysis:
#Question 1 - How does pupation time change with increasing predators
#Use data only from high densities:100 and 155
#Females
names(wing)
wing<-wing[complete.cases(wing$pupation_time),]
wingf<-wing[wing$sex=="f",]
wingfh<-wingf[wingf$conspecific==155,]
head(wingfh)
shapiro.test(wingfh$pupation_time)
str(wingfh)
mod_wingfh<-lm(pupation_time~predator, data=wingfh)
summary(mod_wingfh)
plot(mod_wingfh)
predict(mod_wingfh, wingfh[wingfh$predator==0,], type="response")
122.69-88.29
34.4/122.69
#plot(mod_wingfh)
plot(pupation_time~predator, data=wingfh, pch=19, ylab="Pupation_time", xlab="Predator density")
lines(fitted(mod_wingfh)~wingfh$predator, lty=1, col="red", lwd=2)
##To assess significance, we used rarified data and permutation tests and bootstrapped ci on coefficients
table(wingfh$predator)
#dummy dataframe for resampling as smallest size 15
pre<-rep(c(0,1,2,4), each=15) # multiply the number by 3
pre
dummy<-as.data.frame(pre)
mod_wingfh<-lm(pupation_time~predator, data=wingfh)
summary(mod_wingfh)
orig.res <- coef(mod_wingfh)
#same as mixed effects model
head(mod_wingfh)
#Final analysis:
#Question 1 - How does pupation time change with increasing predators
#Use data only from high densities:100 and 155
#Females
names(wing)
wing<-wing[complete.cases(wing$pupation_time),]
wingf<-wing[wing$sex=="f",]
wingfh<-wingf[wingf$conspecific==155,]
head(wingfh)
mod_wingfh<-lmer(pupation_time~predator+trial+(1|plate), data=wingfh)
summary(mod_wingfh)
mod1<-update(mod_wingfh,~.-predator)
anova(mod_wingfh,mod1)
wing<-wing[complete.cases(wing$pupation_time),]
wingm<-wing[wing$sex=="m",]
wingmh<-wingm[wingm$conspecific==155,]
head(wingmh)
mod_wingmh<-lmer(pupation_time~predator+trial+(1|plate), data=wingmh)
summary(mod_wingmh)
mod1<-update(mod_wingmh,~.-predator)
anova(mod_wingmh,mod1)
mod_wingmh<-lmer(pupation_time~predator+(1|plate), data=wingmh)
summary(mod_wingmh)
mod1<-update(mod_wingmh,~.-predator)
mod1<-update(mod_wingmh,~.-predator)
anova(mod_wingmh,mod1)
mod_wingmh<-lmer(pupation_time~predator+trial+(1|plate), data=wingmh)
summary(mod_wingmh)
mod1<-update(mod_wingmh,~.-trial)
anova(mod_wingmh,mod1)
mod1<-update(mod_wingmh,~.-predator)
mod_wingmh<-lmer(pupation_time~predator+(1|plate), data=wingmh)
summary(mod_wingmh)
mod1<-update(mod_wingmh,~.-predator)
anova(mod_wingmh,mod1)
##Question 2
#effect of adding one predator
wing1f<-wingf[wingf$predator==0 | wingf$predator==1,]
#for females
head(wing1f)
table(wing1f$conspecific, wing1f$predator)
## using only 45 to 155
wing1f<-wing1f[wing1f$conspecific!=20 & wing1f$conspecific!=30,]
table(wing1f$conspecific, wing1f$predator)
str(wing1f)
wing1f$predator<-as.factor(wing1f$predator)
mod_wing1f<-lm(pupation_time~predator*conspecific, data=wing1f)
summary(mod_wing1f)
#same with mixed effects
mod_wing1f<-lmer(pupation_time~predator*conspecific+(1|plate), data=wing1f)
summary(mod_wing1f)
mod1<-update(mod_wing1f,~.-predator:conspecific)
anova(mod_wing1f,mod1)
mod2<-update(mod1,~.-predator)
anova(mod2,mod1)
mod3<-update(mod1,~.-conspecific)
anova(mod3,mod1)
#for females
head(wing1m)
table(wing1m$conspecific, wing1m$predator)
## using only 45 to 155
wing1m<-wing1m[wing1m$conspecific!=20 & wing1m$conspecific!=30,]
table(wing1m$conspecific, wing1m$predator)
str(wing1m)
mod_wing1m<-lm(pupation_time~as.factor(predator)*conspecific, data=wing1m)
summary(mod_wing1m)
mod<-update(mod_wing1m, ~.-as.factor(predator):conspecific)
anova(mod_wing1m,mod)
mod1<-update(mod, ~.-as.factor(predator))
anova(mod,mod1)
#same with mixed effets model
mod_wing1m<-lmer(pupation_time~predator*conspecific+(1|plate), data=wing1m)
summary(mod_wing1m)
mod1<-update(mod_wing1m,~.-predator:conspecific)
anova(mod_wing1m,mod1)
mod2<-update(mod1,~.-predator)
anova(mod2,mod1)
mod1<-update(mod_wing1m,~.-predator:conspecific)
anova(mod_wing1m,mod1)
mod2<-update(mod1,~.-predator)
anova(mod2,mod1)
mod3<-update(mod1,~.-conspecific)
anova(mod3,mod1)
#Metapopulation models
m<-0.15
e<-0.1
s<-(1-e)
N<-matrix(rep(0,10000),nrow=100)
xs<-sample(1:100)
ys<-sample(1:100)
for (i in 1:500){
N[xs[i],ys[i]]<-1 }
image(1:100,1:100,N)
for (t in 1:50){
S <-matrix(runif(10000),nrow=100)
N<-N*(S<s)
im<-floor(sum( N*m))
placed<-matrix(sample(c(rep(1,im) ,rep (0,10000-im))),nrow=100)
N<-N+placed
N<-apply(N,2,function(x) ifelse(x>1,1,x))
image(1:100,1:100,N)
box(col="red")
}
sum(N)/length(N)
#Logistic equation
r = 2.84
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
#Logistic equation
r = 1.2
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
plot(cars)
setwd("/media/manvi/New Volume/Manvi.iisc/Atree_Post_doc/Worksheets/dog_demography_models")
#Logistic equation
r = 1.2
#Logistic equation
r = 1.2
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
plot(X, type="l")
#when r<1
r = 0.4
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
#when r<1
r = -0.4
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
#Logistic equation
#when r>1
r = 0.4
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
#when r<0
r = -1.2
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
#when r<0
r = -0.4
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
#when r>3 - chaotic dynamics
r = 1.2
N = 100
#when r>3 - chaotic dynamics
r = 3.5
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
#when r>2 - chaotic dynamics
r = 2.4
N = 100
K = 5000
t = 50
X<-numeric(50)
X[1]  = N
for(i in 2:t)
{
X[i] = X[i-1]+r*X[i-1]*(1-X[i-1]/K)
}
plot(X, type="l")
